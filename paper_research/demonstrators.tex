\documentclass[review]{elsarticle}

\usepackage[LGR,T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage{textgreek}
\usepackage[greek,english]{babel}
\usepackage[margin=2.5cm]{geometry}
\usepackage{graphicx}
\usepackage{booktabs}
\usepackage{siunitx}
\usepackage{xcolor}
\usepackage{longtable}
\usepackage{multirow}
\usepackage{array}
\usepackage{float}
\usepackage{placeins}
\usepackage{enumitem}
\usepackage{amsmath}
\usepackage{hyperref}

% For placeholder notes during drafting
\newcommand{\todo}[1]{\textcolor{red}{[TODO: #1]}}

% Consistent table column types
\newcolumntype{L}[1]{>{\raggedright\arraybackslash}p{#1}}
\newcolumntype{C}[1]{>{\centering\arraybackslash}p{#1}}
\newcolumntype{R}[1]{>{\raggedleft\arraybackslash}p{#1}}

\journal{Computers, Environment and Urban Systems}

\begin{document}

\begin{frontmatter}

  \title{Seven Exploratory Vignettes for the SOAR Urban Data Model: Illustrative Examples to Encourage Broader Urban Data Applications}

  \author[spacesyntax]{Gareth Simons\corref{cor1}}
  \ead{gareth.simons@ucl.ac.uk}
  \cortext[cor1]{Corresponding author}

  \author[spacesyntax]{Kayvan Karimi}
  \author[spacesyntax]{Sepehr Zhand}

  \affiliation[spacesyntax]{organization={Space Syntax Laboratory, UCL Bartlett School of Architecture},
    addressline={22 Gordon Street},
    city={London},
    country={United Kingdom}
  }

  \begin{abstract}
    Large-scale urban datasets offer substantial opportunities for comparative research across cities and regions. This paper presents exploratory worked examples using the SOAR urban data model---a pan-European dataset covering 699 cities with over 100 metrics per street network node. We provide seven vignette templates demonstrating how workflows can leverage the data for data quality filtering, multi-scale analysis, access gap identification, predictive modelling, city benchmarking, typology classification, and site selection. Each vignette provides a reproducible workflow with code, results, and suggested extensions. These are illustrative starting points rather than definitive findings---templates to help researchers get started with the data and build more rigorous investigations. The purpose is to lower the barrier to entry for researchers exploring pan-European urban analysis.
  \end{abstract}

  \begin{keyword}
    urban data models \sep
    comparative urban analysis \sep
    walkability \sep
    data quality assessment \sep
    accessibility metrics \sep
    European cities \sep
    reproducible research \sep
    POI saturation
  \end{keyword}

\end{frontmatter}

%% ============================================================================
%% INTRODUCTION
%% ============================================================================
\section{Introduction}

Large-scale urban datasets offer substantial opportunities for comparative research, but realising their potential requires understanding what questions the data can address and how analytical workflows might be structured. This paper provides worked examples using the SOAR (Scalable, Open, Automated, and Reproducible) urban data model, demonstrating the range of questions the data can support and lowering the barrier to entry for researchers exploring pan-European urban analysis.

This paper presents exploratory vignettes---worked examples that combine motivation, methodology, analysis, and interpretation. These are explicitly \textit{not} definitive research findings. Each vignette is a starting point: a demonstration of what the data contains and how it might be used as part of urban analytical workflows. The vignettes are intentionally simple, using relatively standard Python workflows and related methods (correlations, Random Forests, clustering). Researchers pursuing rigorous investigations should treat these as templates to get started with the data and on which more rigorous work can be developed. Each vignette includes:

\begin{itemize}[nosep]
  \item Research motivation
  \item SOAR metrics utilised
  \item Analytical workflow and code
  \item Results
  \item Possible extensions
\end{itemize}

The remainder of this paper is structured as follows: Section~2 introduces the SOAR data model; Sections~3--9 present seven vignettes covering data quality, multi-scale analysis, access gaps, predictive modelling, benchmarking, typology classification, and site selection; Section~10 discusses cross-cutting themes and limitations; Section~11 concludes.

%% ============================================================================
%% INTRODUCTION TO SOAR
%% ============================================================================
\section{Introduction to SOAR}

SOAR is a pan-European urban data model providing pre-computed metrics for 699 urban centres defined by Eurostat Urban Audit boundaries~\cite{simons2024soar}. The dataset integrates multiple open data sources: Eurostat census grids (population, demographics), Copernicus Urban Atlas (land cover, green space, building footprints), and Overture Maps (POI locations, transport infrastructure, street networks). For each city, metrics are computed at the street network node level, yielding over 100 variables per node across multiple spatial scales (200--4,800m). The data paper~\todo{citation} provides full technical documentation of the dataset structure, processing pipeline, and metric definitions.

The metric categories include: (1) \textbf{network centrality}---closeness and betweenness at multiple radii capturing pedestrian and neighbourhood-scale accessibility; (2) \textbf{land-use accessibility}---network distances to nearest POI in 11 categories plus diversity indices; (3) \textbf{building morphology}---density, height, footprint area, and form complexity; (4) \textbf{green space proximity}---distances to parks and tree canopy; and (5) \textbf{census demographics}---population density and age structure interpolated to network nodes.

This consistent feature set across 699 cities enables diverse analytical applications:
\begin{itemize}[nosep]
  \item \textbf{Data quality filtering}: Identifying cities with saturated POI coverage for downstream analysis
  \item \textbf{Multi-scale analysis}: Comparing within-city patterns to between-city relationships
  \item \textbf{Access gap identification}: Locating underserved areas using distance-to-nearest metrics
  \item \textbf{Predictive modelling}: Training generalisable models across multiple urban contexts
  \item \textbf{Benchmarking}: Ranking cities against policy targets or peer comparisons
  \item \textbf{Typology classification}: Identifying recurring neighbourhood types across cities
  \item \textbf{Site selection}: Filtering locations by multiple criteria for planning or intervention
\end{itemize}
The vignettes that follow provide reproducible worked examples for each application type.

%% ============================================================================
%% VIGNETTE 1: DATA QUALITY FILTERING
%% ============================================================================
\section{Vignette 1: Data Quality Filtering}

\subsection{Motivation}

POI completeness varies geographically, with some regions exhibiting systematic undersaturation. This vignette applies multi-scale regression of POI counts against population densities to identify cities where crowdsourced data may be too sparse for reliable analysis, allowing researchers to filter or weight observations accordingly.

\subsection{SOAR Metrics Utilised}

\begin{itemize}[nosep]
  \item \textbf{POI counts}: 11 land-use categories (accommodation, active\_life, arts\_and\_entertainment, attractions\_and\_activities, business\_and\_services, eat\_and\_drink, education, health\_and\_medical, public\_services, religious, retail)
  \item \textbf{Census demographics}: Population counts at 1~km\textsuperscript{2} grid resolution
  \item \textbf{Multi-scale neighbourhoods}: Local (2~km), intermediate (5~km), and large (10~km) radii
\end{itemize}

\subsection{Methodology}

We develop a grid-based multi-scale regression approach to assess POI data saturation across cities, comparing observed POI densities against population-based expectations to identify undersaturated areas that may indicate data incompleteness. This method provides a quantitative foundation for evaluating data quality prior to comparative urban analysis.

\subsubsection{Multi-Scale Regression Workflow}
The saturation assessment workflow (\texttt{paper\_research/code/eg1\_data\_quality/}) operates at the 1~km\textsuperscript{2} census grid level, enabling fine-grained spatial analysis:

\begin{enumerate}
  \item \textbf{Grid-level aggregation}: POI counts are computed within each census grid cell. Multi-scale population neighborhoods are calculated at local, intermediate, and large radii to capture hierarchical catchment effects.
  \item \textbf{Random Forest regression}: For each land-use category $k$, a Random Forest model is fitted in log-space:
    \begin{equation}
      \log(\text{POI}_k + 1) = f(\log(\text{pop}_{\text{local}}), \log(\text{pop}_{\text{intermediate}}), \log(\text{pop}_{\text{large}})) + \epsilon
    \end{equation}
    Log transformation linearizes the power-law relationship between population and POI counts ($\text{POI} \propto \text{pop}^\beta$), yielding more normally distributed residuals suitable for z-score computation.
  \item \textbf{Z-score computation}: Standardized residuals quantify deviation from expected POI counts. Negative z-scores indicate undersaturation (fewer POIs than expected); positive z-scores indicate saturation.
  \item \textbf{City-level aggregation}: Grid z-scores are aggregated per city, computing mean (overall saturation level) and standard deviation (spatial variability within city).
  \item \textbf{Quadrant classification}: Cities are classified by mean z-score $\times$ variability into four quadrants: consistently undersaturated, variable undersaturated, consistently saturated, and variable saturated.
\end{enumerate}

\subsubsection{Quadrant Interpretation}
The quadrant classification provides actionable guidance for data usage:
\begin{itemize}
  \item \textbf{Consistently Undersaturated} (low mean, low std): Systematic data gaps; use with caution across all analyses
  \item \textbf{Variable Undersaturated} (low mean, high std): Partial coverage; some grid cells may be reliable
  \item \textbf{Consistently Saturated} (high mean, low std): Complete coverage; suitable for all analyses
  \item \textbf{Variable Saturated} (high mean, high std): Good overall coverage with spatial heterogeneity
\end{itemize}

\subsection{Results}

Analysis of 699 European urban centres reveals a core-periphery pattern in POI data saturation. Central and Western European cities (Germany, Netherlands, France, Belgium) achieve mean z-scores near zero with low spatial variability, indicating a higher likelihood of reliable data. Peripheral European regions show more prevalent undersaturation: Spanish cities (particularly Madrid satellites) average $-0.6$ to $-1.1$, with similar patterns in Romania, Bulgaria, Poland, and southern Italy.

This pattern likely reflects differential OpenStreetMap contributor activity, varying commercial formalisation practices, and regional differences in POI aggregator coverage. The effect is pronounced for business services and retail (R²=0.73, 0.70), while accommodation shows weakest predictability (R²=0.56), suggesting tourism infrastructure follows different spatial logic.

Table~\ref{tab:model_performance} summarises Random Forest model performance by POI category. R\textsuperscript{2} values range from 0.56 (accommodation) to 0.73 (business services), with local population scale consistently the strongest predictor for everyday amenities (retail, eat\_and\_drink, health\_and\_medical) while intermediate-scale population better predicts destination categories (attractions\_and\_activities).

\begin{table}[htbp]
  \centering
  \caption{Random Forest regression performance by POI category. Local, intermediate, and large columns show relative feature importance for each population scale.}
  \label{tab:model_performance}
  \small
  \input{code/eg1_data_quality/outputs/table_model_performance.tex}
\end{table}

\begin{figure}[htbp]
  \centering
  \includegraphics[width=0.95\textwidth]{code/eg1_data_quality/outputs/feature_importance.png}
  \caption{Feature importance showing which population scale (local, intermediate, large) best predicts POI distribution for each category.}
  \label{fig:saturation-importance}
\end{figure}

\begin{figure}[htbp]
  \centering
  \includegraphics[width=0.95\textwidth]{code/eg1_data_quality/outputs/eda_analysis.png}
  \caption{Exploratory data analysis. Left: Random Forest model fit (R\textsuperscript{2}) by POI category. Right: distribution of z-scores across grid cells per category.}
  \label{fig:saturation-eda}
\end{figure}

\begin{figure}[htbp]
  \centering
  \includegraphics[width=0.95\textwidth]{code/eg1_data_quality/outputs/regression_diagnostics.png}
  \caption{Regression diagnostics: predicted vs.\ observed POI counts (log scale) for each category.}
  \label{fig:saturation-diagnostics}
\end{figure}

\begin{figure}[htbp]
  \centering
  \includegraphics[width=0.95\textwidth]{code/eg1_data_quality/outputs/city_quadrant_analysis.png}
  \caption{City quadrant analysis. X-axis: mean z-score (negative = undersaturation). Y-axis: standard deviation (within-city variability). Quadrant colours: red = consistently undersaturated; green = consistently saturated; orange = variable undersaturated; blue = variable saturated.}
  \label{fig:saturation-quadrant}
\end{figure}

\subsection{Implications}

Researchers comparing POI-derived metrics across European cities should account for systematic data quality variation. Options include: (1) restricting analyses to consistently saturated cities; (2) stratifying by saturation quadrant; or (3) applying z-score corrections in undersaturated regions.

\subsection{Extensions}

Potential directions: temporal trends in POI completeness; category-specific quality metrics; validation against municipal records; correlations between data quality and urban characteristics; saturation vectors as city-level features.

\subsection{Reproducibility}

Code, outputs, and documentation: \url{https://github.com/UCL/t2e-soar/tree/main/paper_research/code/eg1_data_quality/}

%% ============================================================================
%% VIGNETTE 2: MULTI-SCALE ANALYSIS
%% ============================================================================
\section{Vignette 2: Multi-Scale Analysis}

\subsection{Motivation}

Relationships observed within cities may differ from those observed between cities. SOAR enables both within-city analysis and city-level aggregations for cross-city comparison, and the two perspectives can yield different conclusions. This vignette explores the topic in the context of access to green spaces, examining within-city correlations between population density and green space proximity.

\subsection{SOAR Metrics Utilised}

\begin{itemize}[nosep]
  \item \textbf{Green space accessibility}: Network distance to nearest green block (1,600m catchment)
  \item \textbf{Tree canopy accessibility}: Network distance to nearest tree canopy (1,600m catchment)
  \item \textbf{Population density}: Persons per km² (interpolated from Eurostat 1km grid)
\end{itemize}

\subsection{Methodology}

For each city with $\geq$100 street network nodes, we compute Spearman rank correlations between population density and distance to green space/tree canopy as well as area of green space/tree canopy. Negative correlations indicate compact urban cores with proximate green access (``dense-and-green''), while positive correlations suggest peripheral green amenities with undersupplied centres (``dense-but-grey''). Results are visualised as diverging bar charts sorted by correlation strength, with cities categorised by the direction and magnitude of their density-green relationship.

\subsection{Results}

Analysis of 672 cities across 16.6 million street network nodes suggests a consistent within-city pattern for green blocks alongside contrasting behavior for tree canopy:

\textbf{Green space (parks):} 666 cities (99\%) exhibit positive correlations, where denser areas face longer walks to parks. Median distance is 93.5m, with 91.0\% of nodes within a 5-minute walk (400m). The strongest positive correlation (Verviers, Belgium: $\rho=0.81$) exemplifies peripheral park placement, while rare negative outliers like Meiderich/Beeck, Germany ($\rho=-0.07$) and P\l{}ock, Poland ($\rho=-0.05$) demonstrate integrated green infrastructure in high-density zones.

\textbf{Tree canopy:} 569 cities (85\%) show negative correlations, indicating that denser neighbourhoods have \textit{better} tree canopy access. Median distance is 72.2m, with 91.2\% within 400m. Strong negative correlations (e.g., Valdemoro, Spain: $\rho=-0.67$; Coslada, Spain: $\rho=-0.60$) suggest street tree programmes concentrated in urban cores, likely reflecting municipal maintenance priorities and sidewalk infrastructure availability.

\begin{figure}[htbp]
  \centering
  \includegraphics[width=0.95\textwidth]{code/eg2_multiscale/outputs/correlation_vs_density.png}
  \caption{\textbf{Green space accessibility and tree canopy versus population density.} $2 \times 2$ grid comparing distance metrics (top row) and correlation analysis (bottom row) across 491 European cities. Left column: green blocks (parks). Right column: tree canopy. Points colored by Spearman correlation strength (blue=negative, red=positive). Top panels show no systematic relationship between city-level density and mean green distance; bottom panels confirm the absence of cross-city patterns for density-access correlations.}
  \label{fig:greenspace-correlation-density}
\end{figure}

\begin{figure}[htbp]
  \centering
  \includegraphics[width=0.95\textwidth]{code/eg2_multiscale/outputs/city_density_correlations.png}
  \caption{\textbf{Per-city correlation patterns for green space accessibility.} Diverging bar chart ranking cities by density-green correlation. For green blocks: only 4 cities show negative correlations (dense neighborhoods closer to parks); 487 cities show positive correlations (parks in peripheries). For tree canopy: 478 cities show negative correlations (street trees in urban cores); only 13 show positive correlations.}
  \label{fig:greenspace-city-correlations}
\end{figure}

\subsection{Discussion}

The central finding illustrates the importance of multi-scale analysis: within-city and between-city patterns can diverge. \textbf{Within cities}, denser areas consistently have worse park access (positive correlations with distance, negative with area). However, \textbf{between cities}, there is no systematic relationship---denser cities are not inherently worse for green access than sparser cities. A compact city can have excellent overall green provision even though its densest neighbourhoods are farther from parks than its peripheries.

This divergence matters for policy interpretation. Within-city correlations might suggest that density inherently conflicts with green access, but cross-city comparisons show this is not the case. Dense urban forms can coexist with good green infrastructure; the within-city gradient reflects land economics and planning choices rather than an insurmountable trade-off.

The correlation signs flip between distance and area metrics due to their opposite directionality (nearer is better for distance; larger is better for area), but the substantive pattern is consistent: denser areas within cities have worse park access by both measures. The tree canopy pattern reverses, though this is partly a data artefact: the Copernicus Street Tree Layer specifically captures urban tree canopy and does not extend to peripheral areas, so denser zones naturally show better coverage.

\subsection{Extensions}

Potential directions: green space quality metrics; breakdown by green space types; behavioural validation; green space typology effects; policy mechanism studies.

\subsection{Reproducibility}

Code, outputs, and documentation: \url{https://github.com/UCL/t2e-soar/tree/main/paper_research/code/eg2_multiscale/}

%% ============================================================================
%% VIGNETTE 3: ACCESS GAP IDENTIFICATION
%% ============================================================================

\section{Vignette 3: Access Gap Identification}

\subsection{Motivation}

Distance-to-nearest metrics can reveal locations where distances to amenities or services are greater than average or exceed targeted thresholds. This vignette demonstrates two basic methods for identifying access gaps: education (spatial equity and absolute access) and transport (demand-supply mismatches). These methods provide basic prototypes for access analysis, though more refined options may be used for detailed analysis depending on specific research questions and policy guidelines.

\subsection{SOAR Metrics Utilised}
\begin{itemize}[nosep]
  \item \texttt{cc\_education\_nearest\_max\_1600}: Network distance to nearest education POI (m)
  \item \texttt{cc\_transport\_nearest\_max\_1600}: Network distance to nearest transport stop (m)
  \item \texttt{cc\_beta\_800}: Local network centrality (demand proxy)
  \item \texttt{density}: Population density (demand proxy)
\end{itemize}

\subsection{Methodology}

We conduct two complementary analyses:

\textbf{Education access:} For cities with \texttt{Consistently Saturated} education POI coverage (from Vignette~1), we compute mean and median network distances to the nearest school, along with the proportion of nodes within 400m and 800m walking distance. To capture spatial equity, we calculate the P75/P25 ratio and the percentage of nodes with access worse than twice the city mean.

\textbf{Transport gaps:} For cities with reliable transport POI coverage, we identify locations where high demand (based on network centrality and population density) coincides with poor transport supply (long distances to nearest stop). Gap areas are classified using percentile thresholds: high-demand nodes (top 30\%) with low transport supply (bottom 30\%) are flagged as gap areas; those with critically low supply (bottom 15\%) are flagged as critical gaps.

\subsection{Results}

\textbf{Education access varies substantially across Europe.} Cities like K\"usnacht (CH) and P\l{}ock (PL) have over 65\% of nodes within a 5-minute walk of a school, while cities like Como (IT) and Iserlohn (DE) have mean distances exceeding 600m. Table~\ref{tab:edu-access} highlights the top and bottom performers.

\begin{table}[htbp]
  \centering
  \caption{Education access: top and bottom cities by mean distance and \% within 400m.}
  \label{tab:edu-access}
  \input{code/eg3_access_gaps/outputs/table_access.tex}
\end{table}

\textbf{Equity is not guaranteed by abundance.} Even in cities with good average access, pockets of disadvantage persist. The P75/P25 ratio ranges from approximately 2.4 to over 6, and in the least equitable cities, a substantial fraction of nodes are severely underserved (Table~\ref{tab:edu-equity}).

\begin{table}[htbp]
  \centering
  \caption{Most and least equitable cities by P75/P25 ratio.}
  \label{tab:edu-equity}
  \input{code/eg3_access_gaps/outputs/table_equity.tex}
\end{table}

\begin{figure}[htbp]
  \centering
  \includegraphics[width=0.95\textwidth]{code/eg3_access_gaps/outputs/education_access_ranking.png}
  \caption{\textbf{Education access rankings.} Left: Top 15 cities with shortest mean distances to education facilities. Right: Bottom 15 cities with longest distances. Colour intensity reflects distance magnitude.}
  \label{fig:edu-access-ranking}
\end{figure}

\begin{figure}[htbp]
  \centering
  \includegraphics[width=0.95\textwidth]{code/eg3_access_gaps/outputs/transport_gap_ranking.png}
  \caption{\textbf{Transport gap rankings.} Top 20 cities by proportion of nodes classified as critical transport gaps (high demand combined with critically low transport supply). These represent locations where network centrality and population density suggest high activity potential, yet transport infrastructure remains distant.}
  \label{fig:transport-gap-ranking}
\end{figure}

\subsection{Discussion}

Educational access varies substantially across Europe, with mean distances ranging from approximately 330m to over 640m across the analysed cities. The P75/P25 ratio---ranging from approximately 2.4 to over 6---distinguishes cities with equitable distribution from those with concentrated provision. Notably, cities with good average access may still have substantial pockets of disadvantage: even well-performing cities show 8--20\% of nodes classified as severely underserved. This highlights why average access metrics can mask substantial within-city disparities.

The methodology outlined for transport gap analysis demonstrates how demand-supply mismatches can be identified by combining centrality (as a proxy for activity potential) with accessibility metrics. Locations where high network centrality and population density coincide with poor transport access represent candidates for further investigation. These are descriptive findings that could inform targeted infrastructure planning, not causal claims about infrastructure adequacy.

\subsection{Extensions}

Potential directions: school capacity and enrolment data; socioeconomic correlates of underserved areas; scenario modelling for new transport stops; temporal trend analysis; case studies of identified gap areas; validation against actual travel behaviour.

\subsection{Reproducibility}

Code, outputs, and documentation: \url{https://github.com/UCL/t2e-soar/tree/main/paper_research/code/eg3_access_gaps/}

%% ============================================================================
%% VIGNETTE 4: PREDICTIVE MODELLING
%% ============================================================================
\section{Vignette 4: Predictive Modelling}

\subsection{Motivation}

Large-scale datasets from multiple cities can enable training of generalisable models. This vignette uses network centrality and population density to predict levels of eating and drinking establishments as well as business and services intensities. The consistent feature set across cities can support transfer learning or pooled models.

\subsection{SOAR Metrics Utilised}

\begin{itemize}[nosep]
  \item \textbf{Network centrality}: Closeness centrality at 400m, 800m, 1,200m, 1,600m, and 4,800m radii
  \item \textbf{POI counts}: Eat \& drink establishments (400m); Business \& services establishments (400m)
  \item \textbf{Census variables}: Population density, age structure (under 15, 15--64, 65+), and employment ratio (interpolated from Eurostat 1km grid)
  \item \textbf{Saturation classification}: From Vignette~1 (cities classified as \texttt{Consistently Saturated})
\end{itemize}

\subsection{Methodology}

We develop an Extra Trees regression approach to predict node-level POI counts based on multi-scale network centrality and census demographics. Analysis is restricted to cities with \texttt{Consistently Saturated} POI coverage for both eat \& drink and business \& services categories (as identified in Vignette~1), yielding 27 cities and 694,527 street network nodes.

\subsubsection{Model Training Workflow}

The workflow (\texttt{paper\_research/code/eg4\_prediction/}) operates at the street network node level:

\begin{enumerate}
  \item \textbf{Data preparation}: Extract closeness centrality metrics at five spatial scales (400--4,800m) and POI counts for eat \& drink and business \& services categories. Filter to cities with consistent saturation to avoid training on incomplete data.
  \item \textbf{Feature engineering}: Combine 5 centrality features with 5 census features (density, age groups, employment). Log-transform all features and targets: $\log(x + 1)$.
  \item \textbf{Train-test split}: Randomly split nodes into 90\% training and 10\% testing sets, stratified by city to ensure geographic representation.
  \item \textbf{Extra Trees training}: Fit separate models for eat \& drink and business \& services. Hyperparameters: 100 estimators, maximum depth of 20.
  \item \textbf{Per-city evaluation}: Compute R\textsuperscript{2}, MAE, and RMSE separately for each city to assess how well the centrality-amenity relationship generalises across urban contexts.
\end{enumerate}

\subsection{Results}

Extra Trees models achieve strong predictive performance on held-out test data: R\textsuperscript{2} = 0.731 for both eat \& drink and business \& services. Per-city R\textsuperscript{2} values reveal how consistently the centrality-amenity relationship holds across different urban forms.

\textbf{Eat \& drink:} Median city R\textsuperscript{2} = 0.709, with 96.3\% of cities achieving R\textsuperscript{2} $>$ 0.5. Italian and Spanish cities dominate the best-predicted list (Table~\ref{tab:amenity-best-eat}), suggesting that network structure strongly determines hospitality location in these contexts. Heerlen (R\textsuperscript{2} = 0.44) shows poorest fit, potentially indicating amenity distributions driven by factors beyond network accessibility.

\textbf{Business \& services:} Median city R\textsuperscript{2} = 0.721, with 100\% of cities exceeding R\textsuperscript{2} $>$ 0.5. The pattern mirrors eat \& drink, with Italian cities showing strongest network-amenity alignment (Table~\ref{tab:amenity-best-business}).

\begin{table}[htbp]
  \centering
  \caption{Top 10 cities by R\textsuperscript{2} for Eat \& Drink (400m).}
  \label{tab:amenity-best-eat}
  \small
  \input{code/eg4_prediction/outputs/table_Eat_and_Drink_400m_cities.tex}
\end{table}

\begin{table}[htbp]
  \centering
  \caption{Top 10 cities by R\textsuperscript{2} for Business \& Services (400m).}
  \label{tab:amenity-best-business}
  \small
  \input{code/eg4_prediction/outputs/table_Business_and_Services_400m_cities.tex}
\end{table}

\textbf{Feature importance} reveals that intermediate-scale closeness centrality (1,200--1,600m) dominates predictions for both categories (Table~\ref{tab:amenity-importance}), consistent with pedestrian catchment theory---amenities locate where they can serve walkable neighbourhoods rather than immediate adjacency (400m) or regional accessibility (4,800m). Census features contribute substantially, with employment ratio and population density ranking among the top predictors.

\begin{table}[htbp]
  \centering
  \caption{Feature importance for Extra Trees regression models.}
  \label{tab:amenity-importance}
  \small
  \input{code/eg4_prediction/outputs/table_feature_importance.tex}
\end{table}

\begin{figure}[htbp]
  \centering
  \includegraphics[width=0.48\textwidth]{code/eg4_prediction/outputs/Eat & Drink 400m_feature_importance.png}
  \includegraphics[width=0.48\textwidth]{code/eg4_prediction/outputs/Business & Services 400m_feature_importance.png}
  \caption{\textbf{Feature importance for amenity prediction models.} Left: Eat \& drink. Right: Business \& services. Intermediate-scale closeness centrality (1,200--1,600m) dominates both models, consistent with pedestrian catchment theory.}
  \label{fig:amenity-importance}
\end{figure}

\begin{figure}[htbp]
  \centering
  \includegraphics[width=0.48\textwidth]{code/eg4_prediction/outputs/Eat & Drink 400m_city_r2_distribution.png}
  \includegraphics[width=0.48\textwidth]{code/eg4_prediction/outputs/Business & Services 400m_city_r2_distribution.png}
  \caption{\textbf{Distribution of per-city R\textsuperscript{2} scores.} Left: Eat \& drink. Right: Business \& services. Most cities cluster at high R\textsuperscript{2} values, with a few outliers showing weaker network-amenity relationships.}
  \label{fig:amenity-r2-dist}
\end{figure}

\subsection{Discussion}

Models achieve R\textsuperscript{2} $>$ 0.7 on held-out data, indicating that network centrality and census features correlate with amenity counts. Intermediate-scale centrality (1,200--1,600m) dominates feature importance.

These are correlational findings. The models do not establish that centrality causes commercial location; both could be driven by underlying factors (land values, zoning, historical development). Per-city variation in model performance suggests the relationship differs across urban contexts.

\subsection{Extensions}

Potential directions: additional explanatory variables (land values, zoning); residual analysis to identify underserved areas; temporal stability; cross-category comparisons; city-specific models.

\subsection{Reproducibility}

Code, outputs, and documentation: \url{https://github.com/UCL/t2e-soar/tree/main/paper_research/code/eg4_prediction/}

%% ============================================================================
%% VIGNETTE 5: BENCHMARKING
%% ============================================================================
\section{Vignette 5: Benchmarking}

\subsection{Motivation}

Cities can be ranked on standardised metrics enabling comparative assessment against peer cities or policy targets. This vignette ranks cities by walkable access to amenities and services, measuring the proportion of locations with access to all of SOAR's major land-use categories within an 800m (approximately 10-minute) pedestrian-scale walking distance.

\subsection{SOAR Metrics Utilised}

\begin{itemize}[nosep]
  \item \textbf{POI network distances}: \texttt{cc\_\{category\}\_nearest\_max\_1600} for 10 essential categories
  \item \textbf{POI categories assessed}: active\_life, arts\_and\_entertainment, attractions\_and\_activities, business\_and\_services, eat\_and\_drink, education, health\_and\_medical, public\_services, religious, retail (accommodation excluded as non-essential for daily access)
  \item \textbf{Saturation classification}: From Vignette~1 (cities with \texttt{Consistently Saturated} or \texttt{Variable Saturated} combined POI coverage)
\end{itemize}

\subsection{Methodology}

We develop a node-level completeness scoring approach to benchmark cities against walkable city ideals. Analysis is restricted to cities with reliable POI coverage across multiple categories (as identified in Vignette~1's between-category quadrant classification).

\subsubsection{Completeness Scoring Workflow}

The workflow (\texttt{paper\_research/code/eg5\_benchmarking/}) operates at the street network node level:

\begin{enumerate}
  \item \textbf{City filtering}: Select cities classified as \texttt{Consistently Saturated} or \texttt{Variable Saturated} in the between-category quadrant analysis (Vignette~1), ensuring reliable POI data across multiple service types.
  \item \textbf{Distance extraction}: For each node, extract network distances to nearest POI in each of 10 categories using SOAR's pre-computed \texttt{cc\_\{category\}\_nearest\_max\_1600} metrics.
  \item \textbf{Per-node completeness}: Count how many of the 10 categories are accessible within 800m (approximately 10 minutes at 80m/min walking speed). A node with ``full access'' reaches all 10 categories within this threshold.
  \item \textbf{City-level aggregation}: Compute the percentage of nodes with full access (all 10 categories within 800m), mean completeness score (average number of accessible categories divided by 10), and per-category access rates.
  \item \textbf{Bottleneck identification}: Identify which POI categories most frequently limit full access, revealing systematic infrastructure gaps.
\end{enumerate}

\subsubsection{Threshold Rationale}

The 800m threshold operationalises a 10-minute walk assuming approximately 80m/min walking speed, consistent with pedestrian planning standards for local accessibility. This threshold captures immediate neighbourhood-scale daily walking catchments and represents a more stringent standard than traditional 15-minute city concepts, better distinguishing genuinely walkable local centres from areas requiring longer trips.

\subsection{Results}

Analysis of cities with reliable POI coverage suggests substantial variation in 10-minute walkable access completeness across European urban centres.

\textbf{Most cities achieve substantial local completeness, though universal coverage within 800m remains challenging.} The median city has nodes with access to all 10 POI categories within 800m, though the precise percentages vary by urban form and service distribution patterns. The gap between median and best performers indicates room for improvement---even cities with good overall accessibility may have neighbourhoods lacking coverage across all service types at this more stringent distance threshold.

\textbf{Top-performing cities in this analysis} demonstrate that compact urban form and mixed-use development can deliver high levels of 10-minute access. Table~\ref{tab:10min-best} shows cities with highest percentages of fully-accessible nodes. These cities share characteristics of pedestrian-oriented development, fine-grained land-use mixing, and comprehensive local service provision.

\begin{table}[htbp]
  \centering
  \caption{Top 10 cities by 10-minute walkable access completeness.}
  \label{tab:10min-best}
  \small
  \input{code/eg5_benchmarking/outputs/table_top_cities.tex}
\end{table}

\textbf{Bottom-performing cities in this analysis} exhibit either sprawling urban form, car-oriented development patterns, or systematic gaps in specific service categories. Table~\ref{tab:10min-worst} highlights cities with lowest completeness scores.

\begin{table}[htbp]
  \centering
  \caption{Bottom 10 cities by 10-minute walkable access completeness.}
  \label{tab:10min-worst}
  \small
  \input{code/eg5_benchmarking/outputs/table_bottom_cities.tex}
\end{table}

\textbf{National differences} are also evident. Table~\ref{tab:10min-country} aggregates city scores by country, showing that Southern European countries (Spain, Romania, Croatia, Italy) tend to have higher proportions of fully accessible nodes compared to Nordic countries (Sweden, Denmark, Norway, Finland), likely reflecting differences in urban density and zoning traditions.

\begin{table}[htbp]
  \centering
  \caption{Country rankings by mean 10-minute walkable access completeness score.}
  \label{tab:10min-country}
  \small
  \input{code/eg5_benchmarking/outputs/table_country_rankings.tex}
\end{table}

\textbf{Bottleneck categories} reveal which services most frequently limit full 10-minute access. Table~\ref{tab:10min-bottlenecks} ranks POI categories by mean access rate, identifying systematic gaps that planners could target for intervention.

\begin{table}[htbp]
  \centering
  \caption{POI categories ranked by mean 10-minute access rate (bottleneck analysis).}
  \label{tab:10min-bottlenecks}
  \small
  \input{code/eg5_benchmarking/outputs/table_bottlenecks.tex}
\end{table}

\begin{figure}[htbp]
  \centering
  \includegraphics[width=0.95\textwidth]{code/eg5_benchmarking/outputs/10min_city_ranking.png}
  \caption{\textbf{10-minute walkable access completeness ranking.} Left: Top 20 cities with highest proportion of nodes achieving full 800m access. Right: Bottom 20 cities. Colour intensity reflects completeness score.}
  \label{fig:10min-ranking}
\end{figure}

\begin{figure}[htbp]
  \centering
  \includegraphics[width=0.7\textwidth]{code/eg5_benchmarking/outputs/completeness_distribution.png}
  \caption{\textbf{Distribution of 10-minute walkable access scores across European cities.} Histogram showing the percentage of nodes with full access to all 10 POI categories within 800m. Red dashed line indicates median.}
  \label{fig:10min-distribution}
\end{figure}

\begin{figure}[htbp]
  \centering
  \includegraphics[width=0.95\textwidth]{code/eg5_benchmarking/outputs/category_access_heatmap.png}
  \caption{\textbf{Per-category access rates for top and bottom cities.} Heatmap showing which POI categories are most/least accessible within 800m. Columns represent categories; rows represent cities. Darker colours indicate lower access rates, revealing category-specific bottlenecks.}
  \label{fig:10min-heatmap}
\end{figure}

\begin{figure}[htbp]
  \centering
  \includegraphics[width=0.7\textwidth]{code/eg5_benchmarking/outputs/country_ranking_chart.png}
  \caption{\textbf{Country rankings by 10-minute walkable access performance.} Bar chart showing mean completeness scores aggregated by country. Southern European countries (Spain, Italy, Croatia) show higher average scores than Nordic countries, likely reflecting differences in urban density and planning traditions.}
  \label{fig:10min-country-chart}
\end{figure}

\subsection{Discussion}

The analysis reveals that full 10-minute access is typically limited by one or two categories rather than general deficits across all services. Certain categories (such as religious facilities and arts \& entertainment venues) consistently emerge as bottlenecks, while others (business \& services, retail) achieve near-universal coverage. This pattern suggests that commercial activities locate to maximise accessibility, while specialised cultural and religious facilities serve larger catchments.

Top-performing cities share characteristics of compact historic cores with fine-grained land-use mixing. Bottom performers tend to be smaller cities or suburban agglomerations where dispersed development patterns limit walkable service provision.

National patterns are evident: Southern European countries (Italy, Spain, Croatia) show higher median completeness than Nordic countries (Sweden, Denmark, Finland), likely reflecting historical urban density, zoning traditions, and car-oriented versus pedestrian-oriented development. However, these patterns should be interpreted cautiously---POI data completeness (Vignette~1) may also vary systematically by region.

This metric is sensitive to category definitions and distance thresholds; different operationalisations would yield different rankings. The 800m threshold operationalises one interpretation of walkable local access, but actual travel times depend on terrain, pedestrian infrastructure quality, and individual mobility.

\subsection{Extensions}

Potential directions: category weighting by use frequency or essentiality; actual routing travel times accounting for pedestrian infrastructure; opening hours analysis to capture temporal accessibility; cycling vs walking comparisons; socioeconomic correlates of access gaps; scenario modelling for targeted infrastructure investment.

\subsection{Reproducibility}

Code, outputs, and documentation: \url{https://github.com/UCL/t2e-soar/tree/main/paper_research/code/eg5_benchmarking/}

%% ============================================================================
%% VIGNETTE 6: TYPOLOGY CLASSIFICATION
%% ============================================================================
\section{Vignette 6: Typology Classification}

\subsection{Motivation}

Clustering algorithms applied to street-level features can identify recurring neighbourhood types that transcend administrative boundaries, revealing morphological similarities across different urban contexts. This vignette applies clustering to identify urban morphological forms and characterises cities by their mix of types.

\subsection{SOAR Metrics Utilised}

\textbf{Morphology features (8 variables at 200m scale, aggregated to nearest adjacent street segments):}
\begin{itemize}[nosep]
  \item \textbf{Density}: Building count, Block count
  \item \textbf{Verticality}: Mean building height (median), Height variation (MAD)
  \item \textbf{Scale}: Building footprint area (median)
  \item \textbf{Form complexity}: Fractal dimension (median)
  \item \textbf{Aggregation}: Block coverage ratio (median), Shared walls ratio (median)
\end{itemize}

\textbf{External characterisation variables:}
\begin{itemize}[nosep]
  \item Population density (persons/km²)
  \item Street network density (street segment count at 1,200m)
  \item Land-use diversity (Hill number $q=0$ at 200m)
\end{itemize}

\subsection{Methodology}

We develop a node-level clustering approach that identifies morphological neighbourhood types across all European cities, then profiles each city and country by their distribution across these types.

\subsubsection{Clustering Workflow}

The workflow (\texttt{paper\_research/code/eg6\_typology/}) operates at the street network node level:

\begin{enumerate}
  \item \textbf{Data preparation}: Extract 8 morphology features at 200m scale for all nodes. Apply log transformation to normalise skewed distributions, then standardise (z-score) across all nodes.
  \item \textbf{BIRCH clustering}: Apply Balanced Iterative Reducing and Clustering using Hierarchies (BIRCH) to identify $k=8$ morphological neighbourhood types. BIRCH provides O(n) complexity suitable for millions of nodes, building a CF-Tree structure with final agglomerative clustering (Ward linkage) on subclusters.
  \item \textbf{External characterisation}: For each cluster, compute mean population density, street network density, and land-use diversity to interpret what each morphological type represents in functional terms.
  \item \textbf{City/country profiling}: Compute the proportion of nodes in each cluster for every city and country, creating compositional vectors that characterise urban form distributions.
  \item \textbf{Contrasting cluster visualisation}: Identify clusters with highest/lowest density and mixed-use values; plot cities by their proportions in these contrasting types to reveal national patterns.
\end{enumerate}

\subsubsection{Feature Selection Rationale}

The 8 features capture complementary dimensions of urban form: density metrics (building and block counts) describe how much is built; verticality metrics (height median and variation) describe the skyline profile; scale (building area) captures footprint size; form complexity (fractal dimension) distinguishes regular from irregular building shapes; and aggregation metrics (block coverage, shared walls) describe how buildings relate to their parcels and neighbours. This parsimonious set avoids redundancy while covering the key morphological dimensions identified in urban morphometrics literature.

\subsection{Results}

Analysis of street network nodes across European cities identifies 8 distinct morphological neighbourhood types with interpretable characteristics.

\textbf{The resulting cluster profiles suggest distinct urban fabrics.} Figure~\ref{fig:morph-radar} shows standardised feature profiles for each cluster, and Table~\ref{tab:morph-clusters} summarises their key characteristics. The clusters span a range of urban forms: high-density clusters (Clusters~1, 4, 6, and 8, all exceeding 12,000 persons/km\textsuperscript{2}) represent dense urban cores with varying morphological characteristics, while low-density clusters (Clusters~2, 3, 5, and 7, ranging from 4,151 to 7,475 persons/km\textsuperscript{2}) capture suburban and peripheral development patterns. Clusters~3 (30.8\% of nodes) and 5 (29.2\%) dominate the sampled network, representing the most common morphological forms across European cities.

\begin{table}[htbp]
  \centering
  \caption{Characteristics of the 8 morphological clusters. Pop Density in persons/km\textsuperscript{2}, Network Density in nodes/km\textsuperscript{2}.}
  \label{tab:morph-clusters}
  \small
  \input{code/eg6_typology/outputs/table_cluster_characteristics.tex}
\end{table}

\textbf{External metrics appear to support cluster interpretations.} Ranking clusters by population density, street network density, and land-use diversity (Figure~\ref{fig:morph-rankings}) confirms that morphological clustering captures functional urban differences. High-density clusters (Clusters~1, 4, 6, 8, ranging from 12,118 to 13,776 persons/km\textsuperscript{2}) exhibit approximately 3$\times$ higher population density than the lowest-density cluster (Cluster~5 at 4,151 persons/km\textsuperscript{2}), with corresponding differences in street network connectivity (ranging from 799 to 1,373 nodes/km\textsuperscript{2}) and mixed-use intensity (Hill $q=0$ from 2.11 to 7.00).

\begin{figure}[htbp]
  \centering
  \includegraphics[width=0.95\textwidth]{code/eg6_typology/outputs/cluster_radar_profiles.png}
  \caption{\textbf{Morphological cluster profiles.} Radar plots showing standardised feature values for each of 8 clusters. Axes represent: Building Count, Block Count, Mean Height, Height Variation, Building Area, Fractal Dimension, Block Coverage, and Shared Walls. Values are z-scores (0 = mean across all clusters).}
  \label{fig:morph-radar}
\end{figure}

\begin{figure}[htbp]
  \centering
  \includegraphics[width=0.95\textwidth]{code/eg6_typology/outputs/cluster_external_rankings.png}
  \caption{\textbf{Clusters ranked by external characteristics.} Horizontal bar charts ranking the 8 morphological clusters by mean population density (left), street network density (centre), and land-use diversity (right). Different clusters rank highest for different metrics: Cluster~1 has highest network density (1,373) and mixed-use diversity (7.00), while Cluster~8 has highest population density (13,160).}
  \label{fig:morph-rankings}
\end{figure}

\textbf{National patterns appear to emerge in city compositions.} When cities are plotted by their proportions in contrasting cluster types (Figure~\ref{fig:morph-cities}), clear geographic patterns appear. Northwestern European cities show strong concentrations in specific cluster types---Netherlands (73.0\% in Cluster~3), Belgium (65.3\% in Cluster~3), and Ireland (64.3\% in Cluster~3)---indicating morphological homogeneity within these countries. Southern European cities show more varied distributions across cluster types. Nordic countries (Denmark, Finland) concentrate in Cluster~5 (51--61\% of nodes), while Greek cities show high proportions in Cluster~1 (35.5\%).

\begin{figure}[htbp]
  \centering
  \includegraphics[width=0.95\textwidth]{code/eg6_typology/outputs/city_profiles_clusters.png}
  \caption{\textbf{City morphology profiles by contrasting cluster proportions.} Left: Cities plotted by percentage of nodes in highest-density vs.\ lowest-density clusters. Right: Cities plotted by percentage in highest vs.\ lowest mixed-use clusters. Points coloured by country. Italian cities (green) cluster toward dense/mixed forms; Eastern European cities spread toward lower-density types.}
  \label{fig:morph-cities}
\end{figure}

\begin{figure}[htbp]
  \centering
  \includegraphics[width=0.7\textwidth]{code/eg6_typology/outputs/country_composition_stacked.png}
  \caption{\textbf{Country morphology compositions.} Stacked bar chart showing the proportion of nodes in each morphological cluster by country. Countries are ordered by hierarchical clustering of their composition vectors, grouping nations with similar urban form distributions.}
  \label{fig:morph-country-stacked}
\end{figure}

\textbf{Countries cluster by morphological similarity.} Hierarchical clustering of country composition vectors (Figure~\ref{fig:morph-country-stacked}) reveals regional groupings: Western European countries (Netherlands, Belgium, Germany) share similar morphological profiles distinct from Southern European (Italy, Spain) and Eastern European (Romania, Poland, Bulgaria) groupings. This suggests that planning traditions, historical development patterns, and regulatory frameworks leave detectable signatures in aggregate urban form.

\begin{figure}[htbp]
  \centering
  \includegraphics[width=0.24\textwidth]{code/eg6_typology/outputs/cluster_1_satellite_5x5.jpg}
  \includegraphics[width=0.24\textwidth]{code/eg6_typology/outputs/cluster_2_satellite_5x5.jpg}
  \includegraphics[width=0.24\textwidth]{code/eg6_typology/outputs/cluster_3_satellite_5x5.jpg}
  \includegraphics[width=0.24\textwidth]{code/eg6_typology/outputs/cluster_4_satellite_5x5.jpg}\\
  \includegraphics[width=0.24\textwidth]{code/eg6_typology/outputs/cluster_5_satellite_5x5.jpg}
  \includegraphics[width=0.24\textwidth]{code/eg6_typology/outputs/cluster_6_satellite_5x5.jpg}
  \includegraphics[width=0.24\textwidth]{code/eg6_typology/outputs/cluster_7_satellite_5x5.jpg}
  \includegraphics[width=0.24\textwidth]{code/eg6_typology/outputs/cluster_8_satellite_5x5.jpg}
  \caption{\textbf{Representative satellite imagery for morphological clusters.} Each panel shows a 5$\times$5 tile grid (zoom level 18) of a representative location for each cluster type. Top row (left to right): Clusters~1--4. Bottom row: Clusters~5--8. Visual inspection confirms that morphological metrics capture meaningful differences in building density, arrangement, and urban fabric. Satellite imagery: ESRI World Imagery (Maxar, Earthstar Geographics, and the GIS User Community).}
  \label{fig:morph-satellite}
\end{figure}

\subsection{Discussion}

The analysis suggests that European cities may share common neighbourhood building blocks despite diverse planning traditions. The 8 clusters span a spectrum from lower-density suburban development (Cluster~5: 4,151 persons/km\textsuperscript{2}) to dense urban cores (Clusters~1, 6, 8: 13,776, 12,118, and 13,160 persons/km\textsuperscript{2} respectively). The most common cluster types are Cluster~3 (30.8\% of sampled nodes) and Cluster~5 (29.2\%), representing moderate-density suburban-to-urban transitional forms that dominate European urban fabric.

The external characterisation reveals that morphological clustering captures meaningful functional differences: population density varies by a factor of 3.3 across clusters (from 4,151 to 13,776 persons/km\textsuperscript{2}), network density by 1.7 (from 799 to 1,373), and land-use diversity (Hill $q=0$) by 3.3 (from 2.11 to 7.00). The clusters represent recognisable urban fabrics that recur across national contexts, but the mix varies systematically by country---Greek cities show high concentrations in Cluster~1 (35.5\%), while Dutch, Belgian, and Irish cities concentrate heavily in Cluster~3 (73.0\%, 65.3\%, and 64.3\% respectively). Nordic countries (Denmark, Finland) show strong presence in Cluster~5 (51--61\% of nodes).

Most cities contain multiple morphological types---this heterogeneity would be invisible in city-level aggregates but is captured by the compositional approach. Country clustering suggests that shared planning histories, housing policies, and development economics leave detectable signatures in aggregate urban form. The distinction between Northwestern European countries (Netherlands, Belgium, Ireland: Cluster~3 dominant with 64--73\%), Nordic countries (Denmark, Finland: Cluster~5 dominant with 51--61\%), and Southern European countries (more varied distributions) aligns with known differences in planning traditions and urban development patterns.

\subsection{Extensions}

Potential directions: temporal evolution of compositions using historical imagery; correlations with urban outcomes (energy use, health, economic activity); transitional neighbourhood identification at cluster boundaries; morphological vs functional similarity comparisons; satellite imagery validation of cluster assignments.

\subsection{Reproducibility}

Code, outputs, and documentation: \url{https://github.com/UCL/t2e-soar/tree/main/paper_research/code/eg6_typology/}

%% ============================================================================
%% VIGNETTE 7: SITE SELECTION
%% ============================================================================
\section{Vignette 7: Site Selection}

\subsection{Motivation}

Large-scale datasets can be filtered by multiple criteria to identify candidate locations for new facilities, housing, or infrastructure investments. This vignette identifies locations with high centrality, mixed uses, and transport access, but lower population density as potential candidates for development.

\subsection{SOAR Metrics Utilised}

\begin{itemize}[nosep]
  \item \textbf{Diversity indices}: Hill numbers ($q=0$, $q=1$, $q=2$) at 400m measuring land-use mix
  \item \textbf{Network centrality}: \texttt{cc\_beta\_1600} (20-minute catchment)
  \item \textbf{Transport access}: \texttt{cc\_transport\_nearest\_max\_1600} (distance to nearest stop)
  \item \textbf{Population density}: \texttt{density} (persons/km²)
  \item \textbf{Saturation classification}: From Vignette~1 (cities with \texttt{Consistently Saturated} or \texttt{Variable Saturated} POI coverage)
\end{itemize}

\subsection{Methodology}

We classify street network nodes into typologies based on combinations of centrality, diversity, transport access, and density. Nodes with high centrality, high diversity, and good transport access but lower population density represent potential development opportunities---locations where urban infrastructure supports intensification but current utilisation is low.

\subsubsection{Classification Workflow}

The workflow (\texttt{paper\_research/code/eg7\_site\_selection/}) operates at the street network node level:

\begin{enumerate}
  \item \textbf{City filtering}: Select cities with reliable POI coverage (as identified in Vignette~1).
  \item \textbf{Metric extraction}: For each node, extract diversity indices, centrality, transport distance, and population density.
  \item \textbf{Threshold classification}: Define high/low thresholds using within-city percentiles (70th percentile for high, 30th for low). Classify nodes as:
    \begin{itemize}[nosep]
      \item Mixed-use dense: High diversity and high density
      \item Mixed-use opportunity: High diversity, high centrality, good transport access, but low density
      \item Single-use dense: Low diversity but high density
      \item Peripheral: Low centrality and low diversity
    \end{itemize}
  \item \textbf{City profiling}: Compute the percentage of nodes in each typology per city.
  \item \textbf{Ranking}: Rank cities by proportion of mixed-use nodes and by proportion of opportunity nodes.
\end{enumerate}

\subsection{Results}

Analysis of cities with reliable POI coverage suggests variation in urban form typologies and development potential.

\textbf{Mixed-use cities} have high proportions of nodes with diverse land-use accessibility, indicating fine-grained mixing of residential, commercial, and service functions. Table~\ref{tab:mixed-use-cities} shows cities with highest mixed-use proportions.

\begin{table}[htbp]
  \centering
  \caption{Cities with highest proportion of mixed-use nodes.}
  \label{tab:mixed-use-cities}
  \input{code/eg7_site_selection/outputs/table_mixed_use_cities.tex}
\end{table}

\textbf{Opportunity cities} have substantial proportions of nodes that combine high connectivity and diversity with lower current population density, suggesting potential for sustainable densification. Table~\ref{tab:opportunity-cities} highlights cities with highest opportunity proportions.

\begin{table}[htbp]
  \centering
  \caption{Cities with highest proportion of development opportunity nodes.}
  \label{tab:opportunity-cities}
  \input{code/eg7_site_selection/outputs/table_opportunity_cities.tex}
\end{table}

\begin{figure}[htbp]
  \centering
  \includegraphics[width=0.48\textwidth]{code/eg7_site_selection/outputs/city_mixed_use_ranking.png}
  \includegraphics[width=0.48\textwidth]{code/eg7_site_selection/outputs/city_opportunity_ranking.png}
  \caption{\textbf{City rankings by urban form typology.} Left: Cities ranked by proportion of mixed-use nodes. Right: Cities ranked by proportion of development opportunity nodes (high connectivity and diversity with lower population density).}
  \label{fig:site-rankings}
\end{figure}

\begin{figure}[htbp]
  \centering
  \includegraphics[width=0.7\textwidth]{code/eg7_site_selection/outputs/typology_distribution.png}
  \caption{\textbf{Distribution of urban form typologies across analysed cities.} Histogram showing the proportion of nodes classified into each typology category (mixed-use dense, mixed-use opportunity, single-use dense, peripheral).}
  \label{fig:typology-distribution}
\end{figure}

\subsection{Discussion}

The typology classification illustrates how to identify locations where infrastructure (connectivity, land-use mix, transport access) exceeds current utilisation (population density). These are not recommendations for development---such decisions require local planning knowledge, market analysis, and community input---but rather a filtering mechanism to identify areas warranting further investigation.

The threshold-based classification is sensitive to parameter choices; different percentile cutoffs would identify different opportunity areas.

\subsection{Extensions}

Potential directions: additional criteria (land ownership, zoning, building age); scenario modelling for new infrastructure; correlation with property values or vacancy rates; longitudinal analysis of densification patterns; case studies of identified opportunity areas.

\subsection{Reproducibility}

Code, outputs, and documentation: \url{https://github.com/UCL/t2e-soar/tree/main/paper_research/code/eg7_site_selection/}

%% ============================================================================
%% DISCUSSION
%% ============================================================================
\section{Discussion}

\subsection{Cross-Cutting Themes}

Across all seven vignettes, several themes emerge: (1) data quality assessment provides a foundation for comparative analysis; (2) multi-scale metrics capture neighbourhood effects at varying radii; (3) node-level granularity identifies within-city inequities missed by coarse zonal aggregations; and (4) reproducible workflows using standardised metrics enable researchers new to spatial network analysis.

\subsection{Limitations}

Each question provides sufficient methodological detail to enable replication. Researchers can expand these analyses with:

\begin{itemize}[nosep]
  \item \textbf{Domain-specific theoretical frameworks}: Grounding analyses in urban planning theory, geography, sociology, economics, or other relevant disciplines
  \item \textbf{Additional validation}: Incorporating field observations, administrative data, surveys, or behavioral data to test whether patterns hold beyond the available metrics
  \item \textbf{Sensitivity analyses}: Examining how results change with different parameter choices, spatial scales, or methodological approaches
  \item \textbf{Longitudinal perspectives}: Adding temporal dimensions to understand how patterns evolve
  \item \textbf{Contextual depth}: Conducting detailed case studies of specific cities or regions to understand local mechanisms
  \item \textbf{Cross-dataset integration}: Combining SOAR with other data sources (mobility data, economic indicators, policy records) for richer analyses
\end{itemize}

Additional limitations include: (1) POI data quality variations across regions (addressed in Vignette~1); (2) temporal constraints (SOAR represents a snapshot); (3) lack of behavioural validation (network distances are proxies for actual travel behaviour); (4) computational requirements; and (5) the inherent limitations of any single dataset in capturing urban complexity.

\subsection{Adapting These Analyses}

Researchers can adapt these analyses by:

\begin{itemize}[nosep]
  \item \textbf{Parameter tuning}: The spatial scales, distance thresholds, and statistical cutoffs used here are starting points; sensitivity testing may reveal more appropriate values for specific contexts
  \item \textbf{Local data integration}: Combining SOAR with municipal datasets, regional surveys, or national statistics can provide validation and additional explanatory power
  \item \textbf{Methodological alternatives}: The analytical approaches demonstrated here (Random Forests, correlations, descriptive statistics) are illustrative; researchers should explore alternative methods (hierarchical models, spatial econometrics, machine learning ensembles) as appropriate
  \item \textbf{Geographic focus}: While we analyze 699 cities, in-depth investigations of subsets (single countries, specific typologies, matched pairs) may yield richer insights
  \item \textbf{Stakeholder engagement}: Collaborating with planners, policymakers, or community organizations can ensure that analyses address real-world priorities and benefit from local knowledge
  \item \textbf{Computational considerations}: Some analyses may benefit from high-performance computing resources, spatial databases, or cloud platforms
\end{itemize}

%% ============================================================================
%% CONCLUSION
%% ============================================================================
\section{Conclusion}

This paper demonstrates the analytical potential of the SOAR urban data model through seven exploratory vignettes spanning data quality assessment, multi-scale analysis, access gap identification, predictive modelling, benchmarking, typology classification, and site selection. Each vignette provides reproducible code and clear workflows that researchers can adapt for their own investigations.

These vignettes are starting points designed to help researchers get started with the data. Building on these templates, researchers can:
\begin{itemize}[nosep]
  \item Ground analyses in domain-specific theory
  \item Validate patterns against local data sources
  \item Conduct sensitivity analyses on parameters and thresholds
  \item Explore causal mechanisms underlying observed patterns
\end{itemize}

The contribution is practical: by providing worked examples across diverse application types, we aim to lower the barrier to entry for pan-European urban research and enable researchers to assess whether SOAR suits their needs.

%% ============================================================================
%% ACKNOWLEDGEMENTS
%% ============================================================================
\section*{Acknowledgements}

This work was supported by the European Union's Horizon programme under the TWIN2EXPAND project. We acknowledge the data providers: Overture Maps Foundation, Copernicus Land Monitoring Service, and Eurostat.

\section*{Funding}

This work was supported by the European Union's Horizon programme under grant agreement No. \todo{no.} (TWIN2EXPAND project).

%% ============================================================================
%% REFERENCES
%% ============================================================================
\bibliographystyle{elsarticle-num}
\bibliography{references}

\end{document}
